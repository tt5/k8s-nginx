apiVersion: v1
kind: ConfigMap
metadata:
  name: nginx-conf
data:
  nginx.conf: |-
    user nginx;
    worker_processes  1;
    events {
      worker_connections  10240;
    }
    http {
      proxy_cache_path /var/cache/nginx levels=1:2 keys_zone=my_cache:5M max_size=1g inactive=10m use_temp_path=on;
      server {
        server_name myserver;
        listen 443 ssl http2;
        ssl_certificate ssl/nginx.crt;
        ssl_certificate_key ssl/nginx.key;

        proxy_cache my_cache;
        #proxy_cache_revalidate on;
        proxy_cache_use_stale updating error timeout http_500 http_502 http_503 http_504;
        proxy_cache_background_update on;
        proxy_cache_lock on;
        proxy_cache_valid any 30s;
        proxy_ignore_headers X-Accel-Expires Expires Cache-Control;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header Host $proxy_host;
        location ^~ / {
          proxy_pass http://first.tt5.workers.dev;
        }
        location ^~ /services/nav {
          rewrite ^/services/nav / break;
          proxy_pass http://nav.tt5.workers.dev;
        }
      }
    }
  nginx.key: |-
    LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUV2Z0lCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktnd2dnU2tBZ0VBQW9JQkFRQytGZGJSS1hFTmFBekwKTUc1RUxrZ0p3VUpmUmkybDhjazdHZ3J5TjBZSms5Y2RmWnRUZy9YUVJlSFdrTkM2c0ZJRmFlelMzYy9PandkOAp5WUhudDNscHF4OE1kbVRGZXRZUkpwZGZiQjMwdUdzWkFIbGNBRHJlSnBiZGtBdS8yQllXYkh3ZXY5ZTJVTGNpCkZhZFZvRytFcDBhOWZZSkZ6NE4rS1BXMHFWZ1ZYWGlPY3NabUEzSDl4aTZ4aGV5SGtZVFh2OGdzOWl3b0k2bi8KOC9IU3RrYTh2NnBaUzZkcEIzNHp0WW52OHo4ajRUKzVPUFZoWnYxS1pwNnJsbnVFcFJoejhTQk1tbGkyMEVYUApNbnBrYmdNVEdOMUJXcVpyK3RBVFEyUTU1LzBXdis0bER1YTF5VGE4V244VFF0dzV6OHJFZG1JcTlQU09aaSttCkRGWDVxMEk3QWdNQkFBRUNnZ0VCQUluMk05blBhRHhBdnJoaXlFVTRDaFQ2YlgvVTRhREZvallCS3R5dC9XbEsKSWlGSFh3cjRoZHJLUGFXTHFkTTEwZklYOVVqK3NLck02TFJMVkx1blVMbSs5MlFHTWhHYW0vQUt3R2NEZzZKdwpqMXF3RzJVSXpiRWE5UGlPYWRpdHJ5cExSckxTcm0rbW1hUmxidlFZNDVlMkNRUFRLbEFjMHVVb09WME1ZOS9zCm5TN0d2NHRkeURKaW9QbldKb2x2RUN4dHgzR1B0WFFobTdSN1dnbk1MRkthK3FMa29SYlVJeWIwOFc5cHZkK3QKd2tDdHhudW5uT2lPbVRTZWYxVEt4WnBjNGNsaVFiQngrMHBaUEVUMytoNDBBTmliY3dOY3YxZGc0ZnR5UCt2RwovaVlrejJtaVlGalprQzg2VFpTRExjQ1BPMldZR3VpQXN2WFNHdlQ3dVhFQ2dZRUEzckFIZDAwYUNpRS9pelViCkxWN25QaFZsemxHUHpoeFFCS0RlcHJpTTUxcTR5WHFwUEVNOW56aTNKUDQzNU9SSnl5UlNQY2NmSmJDbEI2K3QKWjE2aDgzQVpoYkRvdXVqUnN3blBaWHdqdm1PaG94UTZJOU0xQmJBOHJ1aVZNN1VVOWs5V2xzSG4xemJ4STNoOQpnREkwQ2RGUmZCZ3JlQU93cnloZjdXUTlJc2NDZ1lFQTJvVklicElUS1YxalUwMXlsM2FuQkZ2ZUpkSWF0bXRmCmUxdnNjN1ZqVTBUc3YxeXZTdGtJNGk2bVRMa3VxUVc4dGI2WEMvRU1kRWZGQU5TZm5WOGxvVnJDUWhWc2JqUFkKVjA4WlJRZzIrL0QvQ3FrbDZtdis1b2l5NzRHTGVTV0dSaWlGcms2eWdiNTQwZk5OV08raUJ4YmdFdkdyUDJ1dApzMjhnSmtoTmNPMENnWUVBc2FtQzYxMXFEdmJqdVc1UEZtMkcwL05DVzg2YWluZndKeUVwUVo0dlhFejI3RmVlCk9XUHovOW5CMUJPMkNEbFIzbTVGNXQrOEs5ZTRjbDlvV3ZZWEF4OUdYWEQ4M0ZIdks0WUNIeGRoZFA0TDhRMnMKTFBUT2NwRmVlTFU2aEJ4T2N3eHRLcTNkQjhqZnJjcnRaWitvQU1VczIzSjFDN1QxKzJpY3o4cVBNL1VDZ1lBSgpvRXR6aTMzS21iR1JidHo0YlNLb1gzK212TjJ1WVlhQVFhbGw0M3l2bzE2bWcyZTViVndsMHBaQzFQbUlPcGQ0CmpoL0xSK0Fia3puTGNwSmhkVnFNQkJxQW5MNzlEODJjOHdBUytXeXFwcEFsb1JQcGdyNWsyMnErZ0Q5cm84cUoKZHFtRTV6U1g0Sk1qOUlyWXV4MnhJRUhZczhxdWJZam1XYVBaNjk5MWRRS0JnQml1aFJhRU4wdkxJbUJHeFJBZgpEVDRZVG9rRWRMcEk4VkpvZyt4RDBEaUVtQ1BQbkZkSlVBb0FoZkZyREtIMjFWT2ZWamJDRVBWZWJZT3lJT0dzCnh2aytadzRsV1RXZGdHWW1wVmZDOVl5SDd6a2xXS3VUSmpoSjNlM1kxY2J6MFV0Umh5K1N4cTBuekdTWTdSUGwKVlMvQ1hsVjB3Qms0aUk4YnBiRmlNRmQ2Ci0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS0K
  nginx.crt: |-
    LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURhekNDQWxPZ0F3SUJBZ0lVSzdEZTlFOEdSdkhGaGpYVVFHVzJPNEFEK0Nvd0RRWUpLb1pJaHZjTkFRRUwKQlFBd1JURUxNQWtHQTFVRUJoTUNRVlV4RXpBUkJnTlZCQWdNQ2xOdmJXVXRVM1JoZEdVeElUQWZCZ05WQkFvTQpHRWx1ZEdWeWJtVjBJRmRwWkdkcGRITWdVSFI1SUV4MFpEQWVGdzB5TWpBM016QXhNRFU1TUROYUZ3MHlNekEzCk16QXhNRFU1TUROYU1FVXhDekFKQmdOVkJBWVRBa0ZWTVJNd0VRWURWUVFJREFwVGIyMWxMVk4wWVhSbE1TRXcKSHdZRFZRUUtEQmhKYm5SbGNtNWxkQ0JYYVdSbmFYUnpJRkIwZVNCTWRHUXdnZ0VpTUEwR0NTcUdTSWIzRFFFQgpBUVVBQTRJQkR3QXdnZ0VLQW9JQkFRQytGZGJSS1hFTmFBekxNRzVFTGtnSndVSmZSaTJsOGNrN0dncnlOMFlKCms5Y2RmWnRUZy9YUVJlSFdrTkM2c0ZJRmFlelMzYy9PandkOHlZSG50M2xwcXg4TWRtVEZldFlSSnBkZmJCMzAKdUdzWkFIbGNBRHJlSnBiZGtBdS8yQllXYkh3ZXY5ZTJVTGNpRmFkVm9HK0VwMGE5ZllKRno0TitLUFcwcVZnVgpYWGlPY3NabUEzSDl4aTZ4aGV5SGtZVFh2OGdzOWl3b0k2bi84L0hTdGthOHY2cFpTNmRwQjM0enRZbnY4ejhqCjRUKzVPUFZoWnYxS1pwNnJsbnVFcFJoejhTQk1tbGkyMEVYUE1ucGtiZ01UR04xQldxWnIrdEFUUTJRNTUvMFcKdis0bER1YTF5VGE4V244VFF0dzV6OHJFZG1JcTlQU09aaSttREZYNXEwSTdBZ01CQUFHalV6QlJNQjBHQTFVZApEZ1FXQkJTNldyL3RkSzN2aExucS83ZVhucW5zSWNsVVZEQWZCZ05WSFNNRUdEQVdnQlM2V3IvdGRLM3ZoTG5xCi83ZVhucW5zSWNsVVZEQVBCZ05WSFJNQkFmOEVCVEFEQVFIL01BMEdDU3FHU0liM0RRRUJDd1VBQTRJQkFRQ3kKQUhXT2Z6YkRjOHRoZTA2QmJWNjBRYlpJa2ZTODZlejFIRmVEVVpFZUZmQ1E5enl6SGxyREEzQWg1dEorRW94eApZbTJsZnFZQ3YvaGNYcEZiUktqcTNjWTRmSUlibHhRdVFkMVordmx3WmYzY2Q4WENjUlFGQkp2NEtYajFnaXhECjFiV2FVOXJHelhXaW1zMkJBTUVmc0tzWHhUYXV1RGhlNUhOU3ZlaDRySmRHdVRtWUxnZzRSdS9zTlNwNW1xUmMKL2NhVTVOMERMMTZoTDN3QWNlN25xOWtqWHZYWDhvNk03OWEzUHI2bVY2cGpuUk50bk4yU0wzWStScnlLakpzNwpwUzlsc05paFNkUVpqUXFDbkVlQ2FlcWc5OE54WXIyNHUwRjBXbjZrbWlkZldodWpCWmp5MTRHdW82am5HUy9wCm1sYUZ6RWwzMWlFRGUvRG1kY1ZiCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K


